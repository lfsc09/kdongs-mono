@if (loading()) {
  <div class="loading-bar-box h-72 *:w-1/2!">
    <kdongs-cp-loading-bar size="md" />
  </div>
} @else if (performance() === null) {
  <div class="error-box h-72">
    <div class="error-content">
      <span class="emo-flip"></span>
      <span>Failed to load Indicators</span>
    </div>
  </div>
} @else {
  <div class="flex flex-col gap-6">
    <div class="flex flex-col gap-2">
      <span class="text-2xl font-medium text-lime-500 select-none">Indicators</span>
      <span class="chip chip-xs bg-background-2 w-fit font-bold"
        >{{ performance()?.dateStartUtc | date: 'MMM yyyy' }} -
        {{ performance()?.dateEndUtc | date: 'MMM yyyy' }}</span
      >
    </div>
    <div class="grid grid-cols-8 gap-4">
      <div class="card col-span-2 flex flex-col justify-center gap-4">
        <span class="font-bold text-lime-500">NÂ° of Assets</span>
        <div class="flex w-full flex-1 flex-col justify-start gap-4">
          <div class="flex flex-col gap-1">
            <div class="flex flex-row justify-between gap-2">
              <span class="text-xs font-bold">Total:</span>
              <span class="text-[.7rem]">{{ performance()?.numberOfAssets }}</span>
            </div>
            <div class="flex flex-row justify-between gap-2">
              <span class="ml-4 text-xs">Profitable:</span>
              <span class="text-[.7rem]">{{ performance()?.numberOfAssetsProfit }}</span>
            </div>
            <div class="flex flex-row justify-between gap-2">
              <span class="ml-4 text-xs">Unprofitable:</span>
              <span class="text-[.7rem]">{{ performance()?.numberOfAssetsLoss }}</span>
            </div>
          </div>
          <div class="flex flex-col gap-1">
            <div class="flex flex-row justify-between gap-2">
              <span class="text-xs font-bold">Active:</span>
              <span class="text-[.7rem]">{{ performance()?.numberOfActiveAssets }}</span>
            </div>
            <div class="flex flex-row justify-between gap-2">
              <span class="ml-4 text-xs">Profitable:</span>
              <span class="text-[.7rem]">{{ performance()?.numberOfActiveAssetsProfit }}</span>
            </div>
            <div class="flex flex-row justify-between gap-2">
              <span class="ml-4 text-xs">Unprofitable:</span>
              <span class="text-[.7rem]">{{ performance()?.numberOfActiveAssetsLoss }}</span>
            </div>
          </div>
        </div>
      </div>
      <div class="card col-span-2 flex flex-col justify-center gap-4">
        <span class="font-bold text-lime-500">Net Expectancy</span>
        <div class="flex w-full flex-1 flex-col justify-start gap-1">
          <div class="flex flex-row justify-between gap-2">
            <span class="text-xs font-bold">By Asset</span>
            <span class="text-[.7rem]">{{
              performance()?.expectancyByAsset
                | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
            }}</span>
          </div>
          <div class="flex flex-row justify-between gap-2">
            <span class="text-xs font-bold">Avg. Days</span>
            <span class="text-[.7rem]">~{{ performance()?.avgDaysByAsset }}</span>
          </div>
          <div class="flex flex-row justify-between gap-2">
            <span class="ml-4 text-xs">By. Day:</span>
            <span class="text-[.7rem]">{{
              performance()?.expectancyByDay
                | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
            }}</span>
          </div>
          <div class="flex flex-row justify-between gap-2">
            <span class="ml-4 text-xs">By. Month:</span>
            <span class="text-[.7rem]">{{
              performance()?.expectancyByMonth
                | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
            }}</span>
          </div>
          <div class="flex flex-row justify-between gap-2">
            <span class="ml-4 text-xs">By. Quarter:</span>
            <span class="text-[.7rem]">{{
              performance()?.expectancyByQuarter
                | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
            }}</span>
          </div>
          <div class="flex flex-row justify-between gap-2">
            <span class="ml-4 text-xs">By. Year:</span>
            <span class="text-[.7rem]">{{
              performance()?.expectancyByYear
                | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
            }}</span>
          </div>
        </div>
      </div>
      <div class="card col-span-2 flex flex-col justify-center gap-4">
        <span class="font-bold text-red-400">Avg. Cost</span>
        <div class="flex w-full flex-1 flex-col justify-start gap-1">
          <div class="flex flex-row justify-between gap-2">
            <span class="text-xs font-bold">By Asset</span>
            <span class="text-[.7rem]">{{
              performance()?.avgCostByAsset
                | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
            }}</span>
          </div>
          <div class="flex flex-row justify-between gap-2">
            <span class="text-xs font-bold">Avg. Days</span>
            <span class="text-[.7rem]">{{ performance()?.avgDaysByAsset }}</span>
          </div>
          <div class="flex flex-row justify-between gap-2">
            <span class="ml-4 text-xs">By. Day:</span>
            <span class="text-[.7rem]">{{
              performance()?.avgCostByDay
                | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
            }}</span>
          </div>
          <div class="flex flex-row justify-between gap-2">
            <span class="ml-4 text-xs">By. Month:</span>
            <span class="text-[.7rem]">{{
              performance()?.avgCostByMonth
                | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
            }}</span>
          </div>
          <div class="flex flex-row justify-between gap-2">
            <span class="ml-4 text-xs">By. Quarter:</span>
            <span class="text-[.7rem]">{{
              performance()?.avgCostByQuarter
                | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
            }}</span>
          </div>
          <div class="flex flex-row justify-between gap-2">
            <span class="ml-4 text-xs">By. Year:</span>
            <span class="text-[.7rem]">{{
              performance()?.avgCostByYear
                | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
            }}</span>
          </div>
        </div>
      </div>
      <div class="card col-span-2 flex flex-col justify-center gap-4">
        <span class="font-bold text-red-400">Avg. Taxes</span>
        <div class="flex w-full flex-1 flex-col justify-start gap-1">
          <div class="flex flex-row justify-between gap-2">
            <span class="text-xs font-bold">By Asset</span>
            <span class="text-[.7rem]">{{
              performance()?.avgTaxByAsset
                | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
            }}</span>
          </div>
          <div class="flex flex-row justify-between gap-2">
            <span class="text-xs font-bold">Avg. Days</span>
            <span class="text-[.7rem]">{{ performance()?.avgDaysByAsset }}</span>
          </div>
          <div class="flex flex-row justify-between gap-2">
            <span class="ml-4 text-xs">By. Day:</span>
            <span class="text-[.7rem]">{{
              performance()?.avgTaxByDay
                | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
            }}</span>
          </div>
          <div class="flex flex-row justify-between gap-2">
            <span class="ml-4 text-xs">By. Month:</span>
            <span class="text-[.7rem]">{{
              performance()?.avgTaxByMonth
                | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
            }}</span>
          </div>
          <div class="flex flex-row justify-between gap-2">
            <span class="ml-4 text-xs">By. Quarter:</span>
            <span class="text-[.7rem]">{{
              performance()?.avgTaxByQuarter
                | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
            }}</span>
          </div>
          <div class="flex flex-row justify-between gap-2">
            <span class="ml-4 text-xs">By. Year:</span>
            <span class="text-[.7rem]">{{
              performance()?.avgTaxByYear
                | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
            }}</span>
          </div>
        </div>
      </div>
      <div class="card col-span-2 flex flex-col justify-center gap-4">
        <span class="font-bold text-lime-500">Profit Balance</span>
        <div class="flex w-full flex-1 flex-row items-center justify-center">
          <span
            class="font-bold"
            [class]="{
              'text-lime-500':
                (performance()?.resultingBalanceInCurrency ?? 0) >
                (performance()?.movementsSum ?? 0),
              'dark:text-lime-500':
                (performance()?.resultingBalanceInCurrency ?? 0) >
                (performance()?.movementsSum ?? 0),
              'text-red-500':
                (performance()?.resultingBalanceInCurrency ?? 0) <
                (performance()?.movementsSum ?? 0),
              'dark:text-red-400':
                (performance()?.resultingBalanceInCurrency ?? 0) <
                (performance()?.movementsSum ?? 0),
            }"
          >
            {{
              performance()?.resultingBalanceInCurrency
                | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
            }}
          </span>
        </div>
        <div class="flex w-full flex-1 flex-row items-center justify-evenly">
          <span
            class="text-sm"
            [class]="{
              'text-lime-500': (performance()?.resultingProfitInPerc ?? 0) > 0,
              'dark:text-lime-500': (performance()?.resultingProfitInPerc ?? 0) > 0,
              'text-red-500': (performance()?.resultingProfitInPerc ?? 0) < 0,
              'dark:text-red-400': (performance()?.resultingProfitInPerc ?? 0) < 0,
            }"
          >
            {{ performance()?.resultingProfitInPerc | percent: '1.0-2' }}
          </span>
          <span
            class="text-sm"
            [class]="{
              'text-lime-500': (performance()?.resultingProfitInCurrency ?? 0) > 0,
              'dark:text-lime-500': (performance()?.resultingProfitInCurrency ?? 0) > 0,
              'text-red-500': (performance()?.resultingProfitInCurrency ?? 0) < 0,
              'dark:text-red-400': (performance()?.resultingProfitInCurrency ?? 0) < 0,
            }"
          >
            {{
              performance()?.resultingProfitInCurrency
                | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
            }}
          </span>
        </div>
      </div>
      <div class="card flex flex-col justify-center gap-4">
        <span class="font-bold text-lime-500">Breakeven</span>
        <div class="flex w-full flex-1 flex-row items-center justify-evenly">
          @if (performance()?.breakeven === undefined) {
            <span class="emo-shrug text-gray-500"></span>
          } @else {
            <kdongs-cp-gauge
              [value]="(performance()?.breakeven ?? 0) * 100"
              [colorMeter]="[
                { threshold: 50, stroke: 'stroke-lime-500', fill: 'fill-lime-500' },
                { threshold: 75, stroke: 'stroke-amber-500', fill: 'fill-amber-500' },
                { threshold: 100, stroke: 'stroke-red-500', fill: 'fill-red-500' },
              ]"
              size="sm"
            >
              {{ performance()?.breakeven | percent: '1.0-2' }}
            </kdongs-cp-gauge>
          }
        </div>
      </div>
      <div class="card flex flex-col justify-center gap-4">
        <span class="font-bold text-lime-500">Edge</span>
        <div class="flex w-full flex-1 flex-row items-center justify-evenly">
          @if (performance()?.edge === undefined) {
            <span class="emo-shrug text-gray-500"></span>
          } @else {
            <kdongs-cp-gauge
              [value]="(performance()?.edge ?? 0) * 100"
              [colorMeter]="[
                { threshold: 50, stroke: 'stroke-lime-500', fill: 'fill-lime-500' },
                { threshold: 75, stroke: 'stroke-amber-500', fill: 'fill-amber-500' },
                { threshold: 100, stroke: 'stroke-red-500', fill: 'fill-red-500' },
              ]"
              size="sm"
            >
              {{ performance()?.edge | percent: '1.0-2' }}
            </kdongs-cp-gauge>
          }
        </div>
      </div>
      <div class="card col-span-2 flex flex-col justify-center gap-4">
        <span class="font-bold text-lime-500">Profit & Losses</span>
        <div class="flex w-full flex-1 flex-col justify-start gap-4">
          <div class="flex flex-col gap-1">
            <div class="flex flex-row items-center justify-between gap-2">
              <span class="text-xs font-bold">Total Profit</span>
              <span class="text-[.7rem]">{{
                performance()?.netProfitSum
                  | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
              }}</span>
            </div>
            <div class="flex flex-row items-center justify-between gap-2">
              <span class="text-xs font-bold">Avg. Profit</span>
              <span class="text-[.7rem]">{{
                performance()?.netProfitAvg
                  | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
              }}</span>
            </div>
          </div>
          <div class="flex flex-col gap-1">
            <div class="flex flex-row items-center justify-between gap-2">
              <span class="text-xs font-bold">Total Losses</span>
              <span class="text-[.7rem]">{{
                performance()?.netLossSum
                  | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
              }}</span>
            </div>
            <div class="flex flex-row items-center justify-between gap-2">
              <span class="text-xs font-bold">Avg. Loss</span>
              <span class="text-[.7rem]">{{
                performance()?.netLossAvg
                  | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
              }}</span>
            </div>
          </div>
        </div>
      </div>
      <div class="card col-span-2 flex flex-col justify-center gap-4">
        <span class="font-bold text-lime-500">History</span>
        <div class="flex w-full flex-1 flex-col justify-start gap-4">
          <div class="flex flex-col gap-1">
            <div class="flex flex-row items-center justify-between gap-2">
              <span class="text-xs font-bold">Highest Balance</span>
              <span class="text-[.7rem]">{{
                performance()?.historyHigh
                  | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
              }}</span>
            </div>
            <div class="flex flex-row items-center justify-between gap-2">
              <span class="text-xs font-bold">Lowest Balance</span>
              <span class="text-[.7rem]">{{
                performance()?.historyLow
                  | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
              }}</span>
            </div>
          </div>
          <div class="flex flex-col gap-1">
            <div class="flex flex-row items-center justify-between gap-2">
              <span class="text-xs font-bold">Highest Profit</span>
              <span class="text-[.7rem]">{{
                performance()?.netProfitMax
                  | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
              }}</span>
            </div>
            <div class="flex flex-row items-center justify-between gap-2">
              <span class="text-xs font-bold">Highest Loss</span>
              <span class="text-[.7rem]">{{
                performance()?.netLossMax
                  | monetary: investmentsService.currencyToShow() : 'code' : '1.0-2'
              }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
}

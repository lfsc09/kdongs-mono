<div class="flex flex-col gap-2">
  <div class="flex flex-col gap-2">
    <div
      class="bg-background-1 flex flex-row items-center justify-between gap-2 rounded px-6 py-3 shadow"
    >
      <div class="flex gap-2">
        <span class="chip chip-xs select-none">{{
          unifyDatasets() ? 'Unified' : 'Separated'
        }}</span>
        <span class="chip chip-xs select-none">by {{ groupTimeframe() | capitalize }}</span>
        <span class="chip chip-xs select-none"> in {{ groupValueTypeLabel() }} </span>
      </div>
      <button
        type="button"
        [cdkMenuTriggerFor]="options"
        class="group/btn btn btn-sm w-fit transition-transform active:scale-95"
      >
        <i class="fa-solid fa-angle-down"></i>
        <span class="ml-2">Options</span>
      </button>
      <ng-template #options>
        <div
          class="bg-background-0 my-1.5 flex min-w-[300px] flex-col items-start justify-center gap-1.5 rounded p-2 shadow"
          cdkMenu
        >
          <!-- Unify Datasets -->
          <div class="group/info hover:bg-background-1 relative w-full rounded">
            <div
              class="bg-background-2 absolute top-0 -left-4 z-[200] hidden w-64 -translate-x-full rounded p-2 shadow group-hover/info:block"
            >
              <p class="text-xs leading-normal">
                <i class="fa-solid fa-circle-info"></i>
                Unify or separate the wallets into different datasets on the chart.
              </p>
            </div>
            <button
              type="button"
              class="group/btn flex w-full flex-row items-center justify-between gap-6 rounded px-3 py-2.5 transition-transform select-none active:scale-95 disabled:active:scale-100"
              (click)="handleUnifyDatasets()"
              [disabled]="data().length <= 1"
            >
              <span class="text-xs font-medium text-lime-500 capitalize">
                {{ unifyDatasets() ? 'Unified' : 'Separate' }}
              </span>
              <div class="flex flex-1 flex-row items-center justify-end text-sm">
                <i
                  class="fa-solid fa-code-merge mr-2 group-disabled/btn:text-gray-300 group-disabled/btn:dark:text-gray-600"
                ></i>
                <span
                  class="font-medium group-disabled/btn:text-gray-300 group-disabled/btn:dark:text-gray-600"
                >
                  Data Series
                </span>
              </div>
            </button>
          </div>

          <!-- Group by Period -->
          <div class="group/info hover:bg-background-1 relative w-full rounded">
            <div
              class="bg-background-2 absolute top-0 -left-4 z-[200] hidden w-64 -translate-x-full rounded p-2 shadow group-hover/info:block"
            >
              <p class="text-xs leading-normal">
                <i class="fa-solid fa-circle-info"></i>
                Show results grouped by desired period
                <b>Month <i class="text-xs">(Only last 12 months)</i></b
                >, <b>Quarter</b> or <b>Year</b>.
              </p>
            </div>
            <button
              type="button"
              class="group/btn flex w-full flex-row items-center justify-between gap-6 rounded px-3 py-2.5 transition-transform select-none active:scale-95 disabled:active:scale-100"
              (click)="handleGroupTimeFrameChange()"
            >
              <span class="text-xs font-medium text-lime-500 capitalize">
                {{ groupTimeframe() | capitalize }}
              </span>
              <div class="flex flex-1 flex-row items-center justify-end text-sm">
                <i
                  class="fa-solid fa-calendar mr-2 group-disabled/btn:text-gray-300 group-disabled/btn:dark:text-gray-600"
                ></i>
                <span
                  class="font-medium group-disabled/btn:text-gray-300 group-disabled/btn:dark:text-gray-600"
                >
                  Timeframe
                </span>
              </div>
            </button>
          </div>

          <!-- Show in Currency/Percentage -->
          <div class="group/info hover:bg-background-1 relative w-full rounded">
            <div
              class="bg-background-2 absolute top-0 -left-4 z-[200] hidden w-64 -translate-x-full rounded p-2 shadow group-hover/info:block"
            >
              <p class="text-xs leading-normal">
                <i class="fa-solid fa-circle-info text-xs"></i>
                Show results by <b>Percentage (%)</b> or <b>Value</b> on the selected currency.
              </p>
            </div>
            <button
              type="button"
              class="group/btn flex w-full flex-row items-center justify-between gap-6 rounded px-3 py-2.5 transition-transform select-none active:scale-95 disabled:active:scale-100"
              (click)="handleGroupValueTypeChange()"
            >
              <span class="text-xs font-medium text-lime-500 capitalize">
                {{ groupValueType() | capitalize }}
              </span>
              <div class="flex flex-1 flex-row items-center justify-end text-sm">
                <i
                  class="fa-regular fa-eye mr-2 group-disabled/btn:text-gray-300 group-disabled/btn:dark:text-gray-600"
                ></i>
                <span
                  class="font-medium group-disabled/btn:text-gray-300 group-disabled/btn:dark:text-gray-600"
                >
                  Show in
                </span>
              </div>
            </button>
          </div>

          <!-- Compare Input/Gross/Net -->
          <div class="group/info hover:bg-background-1 relative w-full rounded">
            <div
              class="bg-background-2 absolute top-0 -left-4 z-[200] hidden w-64 -translate-x-full rounded p-2 shadow group-hover/info:block"
            >
              <p class="text-xs leading-normal">
                <i class="fa-solid fa-circle-info text-xs"></i>
                Show Net profits only or Input, Gross & Net comparison.
              </p>
            </div>
            <button
              type="button"
              class="group/btn flex w-full flex-row items-center justify-between gap-6 rounded px-3 py-2.5 transition-transform select-none active:scale-95 disabled:active:scale-100"
              (click)="handleCompareNetOnly()"
            >
              <span class="text-xs font-medium text-lime-500 capitalize">
                {{ compareNetOnly() ? 'On' : 'Off' }}
              </span>
              <div class="flex flex-1 flex-row items-center justify-end text-sm">
                <i
                  class="fa-regular fa-eye mr-2 group-disabled/btn:text-gray-300 group-disabled/btn:dark:text-gray-600"
                ></i>
                <span
                  class="font-medium group-disabled/btn:text-gray-300 group-disabled/btn:dark:text-gray-600"
                >
                  Net Only
                </span>
              </div>
            </button>
          </div>
        </div>
      </ng-template>
    </div>
  </div>
  <div class="bg-background-1 flex flex-col gap-1 rounded p-4 shadow">
    <div class="flex flex-row items-center">
      <div id="groupChart"></div>
    </div>
    <div id="groupChartLegend" class="flex flex-row items-center justify-end gap-2"></div>
  </div>
</div>
